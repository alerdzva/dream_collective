{"ast":null,"code":"import _taggedTemplateLiteral from \"/Users/piyum/Desktop/tempfolder/frontend_dreamcollective/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/piyum/Desktop/tempfolder/frontend_dreamcollective/src/components/views/activity/AddResponsesView.js\";\n\nfunction _templateObject12() {\n  const data = _taggedTemplateLiteral([\"\\n  width:20vw;\\n  margin-top:4vw;\\n  \\n  float:right;\\n\"]);\n\n  _templateObject12 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject11() {\n  const data = _taggedTemplateLiteral([\"\\n  width:1.5vh;\\n  height:1.5vh;\\n  background-color:\", \";\\n  border-radius:5vw;\\n\\n  @media \", \" {\\n    width:2vw;\\n    height:2vw;\\n    margin: 4vw auto;\\n  }\\n\"]);\n\n  _templateObject11 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject10() {\n  const data = _taggedTemplateLiteral([\"\\n  width: 10vw;\\n  height: 1.8vh;\\n  margin: auto;\\n  display:flex;\\n  justify-content:space-around;\\n\\n  @media \", \" {\\n    width: 20vw;\\n    height: 3vw;\\n  }\\n\"]);\n\n  _templateObject10 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject9() {\n  const data = _taggedTemplateLiteral([\"\\n  display:flex\\n  justify-content:space-around;  \\n  @media \", \" {\\n    margin:auto;\\n    width:90vw;\\n  }\\n\"]);\n\n  _templateObject9 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject8() {\n  const data = _taggedTemplateLiteral([\"\\nwidth:2vw;\\nheight:2vw;\\ncursor: pointer;\\ntransition: transform .3s;\\noutline:none;\\nmargin:auto 0.2vw;\\n&:hover{\\n  transform:scale(1.1);\\n}\\n\\n@media \", \" {\\n  width:8vw;\\n  height:8vw;\\n  max-height:8vw;\\n  font-size: 5vw\\n}\\n\\n\"]);\n\n  _templateObject8 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7() {\n  const data = _taggedTemplateLiteral([\"\\nfont-size: 1.2vw\\nfont-family: 'Roboto';\\nfont-weight:700;\\ntext-transform:uppercase;\\ncolor: \", \";\\ntext-align:left;\\n\\n@media \", \" {\\n  padding-top:4vw;\\n  font-size: 5vw;\\n}\\n\\n\"]);\n\n  _templateObject7 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  const data = _taggedTemplateLiteral([\"\\n  width:70vw;\\n  /* background-color:\", \"; */\\n  display:flex;\\n  flex-direction:column;\\n  align-items:center;\\n  justify-content: flex-start;\\n\"]);\n\n  _templateObject6 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  const data = _taggedTemplateLiteral([\"\\n  width:30vw;\\n  /* background-color:\", \" */\\n  display:flex;\\n  flex-direction:column;\\n  align-items:center;\\n  justify-content: flex-start;\\n\\n\"]);\n\n  _templateObject5 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  const data = _taggedTemplateLiteral([\"\\nheight:38vh;\\n  display:flex;\\n\"]);\n\n  _templateObject4 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  const data = _taggedTemplateLiteral([\"\\n  position:relative;\\n  margin:auto;\\n  height:60vh;\\n  overflow:visible;\\n  \\n\"]);\n\n  _templateObject3 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  const data = _taggedTemplateLiteral([\"\\n  margin:auto;\\n  position:relative;\\n  width:90vw;\\n  padding-bottom:5vw;\\n\"]);\n\n  _templateObject2 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  position: relative;\\n  padding-bottom: 10vw;\\n\"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component } from \"react\";\nimport styled from \"styled-components\";\nimport Feature, { FeatureType as FeatureTypes } from \"../../feature/Feature\";\nimport NewFeature from \"../../feature/NewFeature\";\nimport Drone from \"../../drone/Drone\";\nimport LoadingWidget from \"../../LoadingWidget\";\nimport { isGibberish } from \"../../../utils.js\";\nimport { devices } from \"../../../devices.js\";\nimport Header from \"../../commons/header/Header\";\nimport Button from \"../../commons/Button\";\nimport { confirmAlert } from 'react-confirm-alert'; // Import\n\nimport 'react-confirm-alert/src/react-confirm-alert.css'; // Import css\n\nimport { theme } from \"../../../config/colorTheme\";\nimport Prompt from \"../../commons/Prompt\";\nimport TextArea from \"../../commons/TextArea\";\nimport Hero from \"../../commons/Hero\";\nconst Wrapper = styled.div(_templateObject());\nconst ContentWrapper = styled.div(_templateObject2());\nconst DroneContainer = styled.div(_templateObject3());\nconst FeatureContainer = styled.div(_templateObject4());\nconst CreateFeatureContainer = styled.div(_templateObject5(), theme.secondaryColor20);\nconst FeatureSetContainer = styled.div(_templateObject6(), theme.primaryColor20);\nconst RowHeader = styled.h3(_templateObject7(), theme.black, devices.mobile);\nconst PaginationButton = styled.img(_templateObject8(), devices.mobile);\nconst FeatureSet = styled.div(_templateObject9(), devices.mobile);\nconst DotWrapper = styled.div(_templateObject10(), devices.mobile);\nconst Dot = styled.div(_templateObject11(), props => props.selected ? theme.secondaryColor : theme.lightGray, devices.mobile);\nconst ButtonWrapper = styled.div(_templateObject12());\n\nvar APICalls = require(\"../../../utils/APICalls\");\n\nconst VISIBLE_FEATURES_COUNT = 3;\nconst FEATURE_SET_SIZE = 12;\n\nclass AddResponsesView extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleAddNewFeatureClick = feature => {\n      let drone = this.state.response;\n\n      if (drone.features.length >= 4) {\n        this.displayMaxFeaturesAlert();\n        return;\n      }\n\n      drone.features.push(feature);\n      this.setState({\n        response: drone\n      });\n      this.updateDrone();\n    };\n\n    this.state = {\n      prompts: [],\n      inputs: [],\n      response: null\n    };\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0); //fetch the response data using id\n\n    APICalls.readResponse(this.props.match.params.id, data => {\n      APICalls.readPromptsOfTopic(data.topic._id, data => {\n        var inputs = [];\n        data.map((value, index) => {\n          inputs.push({\n            prompt: value._id,\n            text: value.startingLine + \"...\"\n          });\n        });\n        this.setState({\n          inputs: inputs,\n          prompts: data\n        });\n      });\n      this.setState({\n        response: data\n      });\n    });\n  }\n\n  updateResponse() {\n    var body = this.state.response;\n    body.inputs = this.state.inputs;\n    body.isPublished = true;\n    fetch(\"/responses/\" + this.state.response._id, {\n      method: \"PUT\",\n      body: JSON.stringify(body),\n      headers: {\n        Accept: \"application/json, text/plain, */*\",\n        \"Content-Type\": \"application/json\",\n        Mode: \"CORS\"\n      }\n    }).then(data => {\n      console.log(data);\n      alert(\"Response Submitted. Thanks for your creativity!\");\n      this.props.history.push(\"../../topic/\" + this.state.response.topic._id);\n    });\n  }\n\n  render() {\n    if (this.state.response == null) return React.createElement(LoadingWidget, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    });\n    return React.createElement(Wrapper, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, React.createElement(Hero, {\n      isSmall: true,\n      onClick: () => this.props.history.push(\"../../\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }), React.createElement(Header, {\n      text: \"Tell us more about your dream \" + this.state.response.topic.name.toLowerCase(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }), React.createElement(ContentWrapper, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, React.createElement(DroneContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, React.createElement(Drone, {\n      editable: false,\n      drone: this.state.response,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    })), this.state.prompts.map((value, index) => React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, React.createElement(Prompt, {\n      text: value.text,\n      marginTop: \"3vw\",\n      marginBottom: \"1vw\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }), React.createElement(TextArea, {\n      value: this.state.inputs[index].text,\n      rows: 8,\n      placeholder: value.startingLine,\n      onChangeCallback: ev => {\n        var inputs = this.state.inputs;\n        inputs[index].text = ev.target.value;\n        this.setState({\n          inputs: inputs\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }))), React.createElement(ButtonWrapper, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, React.createElement(Button, {\n      isDisabled: !this.isCompleted(),\n      onClick: () => this.handleSubmitClick(),\n      text: \"Submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }))));\n  }\n\n  isCompleted() {\n    let input;\n\n    for (let i = 0; i < this.state.inputs.length; i++) {\n      input = this.state.inputs[i].text;\n\n      if (this.state.prompts[i].startingLine.length + 5 < input.length) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  handleSubmitClick() {\n    const message = \"It looks like your submission includes some gibberish. Please make sure your answers are readable. If you believe this is a mistake on our part click skip without making any changes.\";\n    let containsGib = false;\n    let input;\n\n    for (let i = 0; i < this.state.inputs.length; i++) {\n      input = this.state.inputs[i].text;\n\n      if (this.state.prompts[i].startingLine) {\n        input = input.substring(this.state.prompts[i].startingLine.length);\n      }\n\n      if (input.length > 4 && isGibberish(input, 5)) {\n        containsGib = true;\n        break;\n      }\n    }\n\n    if (containsGib) {\n      confirmAlert({\n        title: \"We detected some gibberish!\",\n        message: message,\n        buttons: [{\n          label: \"Skip\",\n          onClick: () => this.updateResponse()\n        }, {\n          label: \"Continue\",\n          onClick: () => {}\n        }]\n      });\n    } else {\n      this.updateResponse();\n    }\n  }\n\n  renderButton() {\n    if (this.state.drone.features.length > 0) {\n      return React.createElement(Button, {\n        onClick: () => {\n          this.props.history.push(\"../story/\" + this.state.drone._id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295\n        },\n        __self: this\n      }, \"Next\");\n    }\n\n    return null;\n  }\n\n  renderScrollDots() {\n    let dots = [];\n    let selected = false;\n    let index = this.state.visiblefeatureIndex;\n    const size = Math.min(this.state.featureSet.length, FEATURE_SET_SIZE);\n\n    for (let i = 0; i < size / VISIBLE_FEATURES_COUNT; i++) {\n      selected = i == index / VISIBLE_FEATURES_COUNT;\n      dots.push(React.createElement(Dot, {\n        selected: selected,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316\n        },\n        __self: this\n      }));\n    }\n\n    return dots;\n  }\n\n  displayMaxFeaturesAlert() {\n    alert(\"Your dream \" + this.state.response.topic.name + \" can have a maximum of 4 superpowers.\");\n  }\n\n  handleNextClick() {\n    let index = this.state.visiblefeatureIndex;\n\n    if (index != null && index + VISIBLE_FEATURES_COUNT < this.state.featureSet.length) {\n      this.setState({\n        visiblefeatureIndex: index + VISIBLE_FEATURES_COUNT\n      });\n    }\n  }\n\n  handlePreviousClick() {\n    let index = this.state.visiblefeatureIndex;\n\n    if (index != null && index - VISIBLE_FEATURES_COUNT >= 0) {\n      this.setState({\n        visiblefeatureIndex: index - VISIBLE_FEATURES_COUNT\n      });\n    }\n  }\n\n}\n\nexport default AddResponsesView;","map":{"version":3,"sources":["/Users/piyum/Desktop/tempfolder/frontend_dreamcollective/src/components/views/activity/AddResponsesView.js"],"names":["React","Component","styled","Feature","FeatureType","FeatureTypes","NewFeature","Drone","LoadingWidget","isGibberish","devices","Header","Button","confirmAlert","theme","Prompt","TextArea","Hero","Wrapper","div","ContentWrapper","DroneContainer","FeatureContainer","CreateFeatureContainer","secondaryColor20","FeatureSetContainer","primaryColor20","RowHeader","h3","black","mobile","PaginationButton","img","FeatureSet","DotWrapper","Dot","props","selected","secondaryColor","lightGray","ButtonWrapper","APICalls","require","VISIBLE_FEATURES_COUNT","FEATURE_SET_SIZE","AddResponsesView","constructor","handleAddNewFeatureClick","feature","drone","state","response","features","length","displayMaxFeaturesAlert","push","setState","updateDrone","prompts","inputs","componentDidMount","window","scrollTo","readResponse","match","params","id","data","readPromptsOfTopic","topic","_id","map","value","index","prompt","text","startingLine","updateResponse","body","isPublished","fetch","method","JSON","stringify","headers","Accept","Mode","then","console","log","alert","history","render","name","toLowerCase","ev","target","isCompleted","handleSubmitClick","input","i","message","containsGib","substring","title","buttons","label","onClick","renderButton","renderScrollDots","dots","visiblefeatureIndex","size","Math","min","featureSet","handleNextClick","handlePreviousClick"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport styled from \"styled-components\";\nimport Feature, { FeatureType as FeatureTypes } from \"../../feature/Feature\";\nimport NewFeature from \"../../feature/NewFeature\";\nimport Drone from \"../../drone/Drone\"\nimport LoadingWidget from \"../../LoadingWidget\";\nimport {isGibberish} from \"../../../utils.js\"\nimport {devices} from \"../../../devices.js\"\nimport Header from \"../../commons/header/Header\"\nimport Button from \"../../commons/Button\"\nimport { confirmAlert } from 'react-confirm-alert'; // Import\nimport 'react-confirm-alert/src/react-confirm-alert.css'; // Import css\n\n\n import {theme} from \"../../../config/colorTheme\";\nimport Prompt from \"../../commons/Prompt\";\nimport TextArea from \"../../commons/TextArea\";\nimport Hero from \"../../commons/Hero\";\n\nconst Wrapper = styled.div`\n  width: 100%;\n  position: relative;\n  padding-bottom: 10vw;\n`;\n\nconst ContentWrapper = styled.div`\n  margin:auto;\n  position:relative;\n  width:90vw;\n  padding-bottom:5vw;\n`;\n\nconst DroneContainer = styled.div`\n  position:relative;\n  margin:auto;\n  height:60vh;\n  overflow:visible;\n  \n`;\n\nconst FeatureContainer = styled.div`\nheight:38vh;\n  display:flex;\n`;\n\nconst CreateFeatureContainer = styled.div`\n  width:30vw;\n  /* background-color:${theme.secondaryColor20} */\n  display:flex;\n  flex-direction:column;\n  align-items:center;\n  justify-content: flex-start;\n\n`;\n\nconst FeatureSetContainer = styled.div`\n  width:70vw;\n  /* background-color:${theme.primaryColor20}; */\n  display:flex;\n  flex-direction:column;\n  align-items:center;\n  justify-content: flex-start;\n`;\n\nconst RowHeader = styled.h3`\nfont-size: 1.2vw\nfont-family: 'Roboto';\nfont-weight:700;\ntext-transform:uppercase;\ncolor: ${theme.black};\ntext-align:left;\n\n@media ${devices.mobile} {\n  padding-top:4vw;\n  font-size: 5vw;\n}\n\n`;\n\nconst PaginationButton = styled.img`\nwidth:2vw;\nheight:2vw;\ncursor: pointer;\ntransition: transform .3s;\noutline:none;\nmargin:auto 0.2vw;\n&:hover{\n  transform:scale(1.1);\n}\n\n@media ${devices.mobile} {\n  width:8vw;\n  height:8vw;\n  max-height:8vw;\n  font-size: 5vw\n}\n\n`;\n\nconst FeatureSet = styled.div`\n  display:flex\n  justify-content:space-around;  \n  @media ${devices.mobile} {\n    margin:auto;\n    width:90vw;\n  }\n`;\n\nconst DotWrapper = styled.div`\n  width: 10vw;\n  height: 1.8vh;\n  margin: auto;\n  display:flex;\n  justify-content:space-around;\n\n  @media ${devices.mobile} {\n    width: 20vw;\n    height: 3vw;\n  }\n`;\n\nconst Dot = styled.div`\n  width:1.5vh;\n  height:1.5vh;\n  background-color:${props => props.selected ? theme.secondaryColor : theme.lightGray};\n  border-radius:5vw;\n\n  @media ${devices.mobile} {\n    width:2vw;\n    height:2vw;\n    margin: 4vw auto;\n  }\n`;\n\nconst ButtonWrapper = styled.div`\n  width:20vw;\n  margin-top:4vw;\n  \n  float:right;\n`;\n\n\nvar APICalls = require(\"../../../utils/APICalls\")\n\nconst VISIBLE_FEATURES_COUNT = 3;\nconst  FEATURE_SET_SIZE = 12;\n\n\nclass AddResponsesView extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      prompts: [],\n      inputs: [],\n      response: null,\n    };\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n\n    //fetch the response data using id\n    APICalls.readResponse(this.props.match.params.id, (data) => {\n      APICalls.readPromptsOfTopic(data.topic._id, (data) => {\n        var inputs = [];\n        data.map((value, index) => {\n          inputs.push({ prompt: value._id, text: value.startingLine + \"...\" });\n        });\n        this.setState({ inputs: inputs, prompts: data });\n      });\n      this.setState({ response: data });\n    });\n  }\n\n  updateResponse() {\n    var body = this.state.response;\n    body.inputs = this.state.inputs;\n    body.isPublished = true;\n    fetch(\"/responses/\" + this.state.response._id, {\n      method: \"PUT\",\n      body: JSON.stringify(body),\n      headers: {\n        Accept: \"application/json, text/plain, */*\",\n        \"Content-Type\": \"application/json\",\n        Mode: \"CORS\",\n      },\n    }).then((data) => {\n      console.log(data);\n      alert(\"Response Submitted. Thanks for your creativity!\");\n      this.props.history.push(\"../../topic/\" + this.state.response.topic._id);\n    });\n  }\n\n  render() {\n    if (this.state.response == null) return <LoadingWidget></LoadingWidget>;\n    return (\n      <Wrapper>\n        <Hero\n          isSmall={true}\n          onClick={() => this.props.history.push(\"../../\")}\n        ></Hero>\n\n        <Header\n          text={\n            \"Tell us more about your dream \" +\n            this.state.response.topic.name.toLowerCase()\n          }\n        ></Header>\n        <ContentWrapper>\n          <DroneContainer>\n            <Drone editable={false} drone={this.state.response}></Drone>\n          </DroneContainer>\n          {this.state.prompts.map((value, index) => (\n            <div>\n              <Prompt\n                text={value.text}\n                marginTop={\"3vw\"}\n                marginBottom={\"1vw\"}\n              ></Prompt>\n              <TextArea\n                value={this.state.inputs[index].text}\n                rows={8}\n                placeholder={value.startingLine}\n                onChangeCallback={(ev) => {\n                  var inputs = this.state.inputs;\n                  inputs[index].text = ev.target.value;\n                  this.setState({ inputs: inputs });\n                }}\n              ></TextArea>\n            </div>\n          ))}\n\n          <ButtonWrapper>\n            <Button\n              isDisabled={!this.isCompleted()}\n              onClick={() => this.handleSubmitClick()}\n              text={\"Submit\"}\n            ></Button>\n          </ButtonWrapper>\n        </ContentWrapper>\n      </Wrapper>\n    );\n  }\n\n  isCompleted() { \n    let input;\n    for (let i = 0; i < this.state.inputs.length; i++) {\n      input = this.state.inputs[i].text;\n      if (this.state.prompts[i].startingLine.length + 5 < input.length) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  handleSubmitClick() {\n    const message =\n      \"It looks like your submission includes some gibberish. Please make sure your answers are readable. If you believe this is a mistake on our part click skip without making any changes.\";\n\n    let containsGib = false;\n    let input;\n    for (let i = 0; i < this.state.inputs.length; i++) {\n      input = this.state.inputs[i].text;\n      if (this.state.prompts[i].startingLine) { \n        input = input.substring(this.state.prompts[i].startingLine.length);\n      }\n      if (input.length > 4 && isGibberish(input, 5)) {\n        containsGib = true;\n        break;\n      }\n    }\n    if (containsGib) {\n      confirmAlert({\n        title: \"We detected some gibberish!\",\n        message: message,\n        buttons: [\n          {\n            label: \"Skip\",\n            onClick: () => this.updateResponse()\n          },\n          {\n            label: \"Continue\",\n            onClick: () => {},\n          },\n        ],\n      });\n    } else {\n      this.updateResponse();\n    }\n  }\n\n  renderButton() {\n    if (this.state.drone.features.length > 0) {\n      return (\n        <Button\n          onClick={() => {\n            this.props.history.push(\"../story/\" + this.state.drone._id);\n          }}\n        >\n          Next\n        </Button>\n      );\n    }\n    return null;\n  }\n\n  renderScrollDots() {\n    let dots = [];\n    let selected = false;\n    let index = this.state.visiblefeatureIndex;\n\n    const size = Math.min(this.state.featureSet.length, FEATURE_SET_SIZE);\n\n    for (let i = 0; i < size / VISIBLE_FEATURES_COUNT; i++) {\n      selected = i == index / VISIBLE_FEATURES_COUNT;\n      dots.push(<Dot selected={selected}></Dot>);\n    }\n    return dots;\n  }\n\n  handleAddNewFeatureClick = (feature) => {\n    let drone = this.state.response;\n    if (drone.features.length >= 4) {\n      this.displayMaxFeaturesAlert();\n      return;\n    }\n    drone.features.push(feature);\n    this.setState({ response: drone });\n    this.updateDrone();\n  };\n\n  displayMaxFeaturesAlert() {\n    alert(\n      \"Your dream \" +\n        this.state.response.topic.name +\n        \" can have a maximum of 4 superpowers.\"\n    );\n  }\n\n  handleNextClick() {\n    let index = this.state.visiblefeatureIndex;\n    if (\n      index != null &&\n      index + VISIBLE_FEATURES_COUNT < this.state.featureSet.length\n    ) {\n      this.setState({ visiblefeatureIndex: index + VISIBLE_FEATURES_COUNT });\n    }\n  }\n\n  handlePreviousClick() {\n    let index = this.state.visiblefeatureIndex;\n    if (index != null && index - VISIBLE_FEATURES_COUNT >= 0) {\n      this.setState({ visiblefeatureIndex: index - VISIBLE_FEATURES_COUNT });\n    }\n  }\n}\n\nexport default AddResponsesView;\n"]},"metadata":{},"sourceType":"module"}