{"ast":null,"code":"import _taggedTemplateLiteral from \"/Users/piyum/Desktop/tempfolder/frontend_dreamcollective/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/piyum/Desktop/tempfolder/frontend_dreamcollective/src/components/views/activity/AddResponsesView.js\";\n\nfunction _templateObject12() {\n  const data = _taggedTemplateLiteral([\"\\n  width: 20vw;\\n  margin-top: 4vw;\\n\\n  float: right;\\n\"]);\n\n  _templateObject12 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject11() {\n  const data = _taggedTemplateLiteral([\"\\n  width: 1.5vh;\\n  height: 1.5vh;\\n  background-color: \", \";\\n  border-radius: 5vw;\\n\\n  @media \", \" {\\n    width: 2vw;\\n    height: 2vw;\\n    margin: 4vw auto;\\n  }\\n\"]);\n\n  _templateObject11 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject10() {\n  const data = _taggedTemplateLiteral([\"\\n  width: 10vw;\\n  height: 1.8vh;\\n  margin: auto;\\n  display: flex;\\n  justify-content: space-around;\\n\\n  @media \", \" {\\n    width: 20vw;\\n    height: 3vw;\\n  }\\n\"]);\n\n  _templateObject10 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject9() {\n  const data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: space-around;\\n  @media \", \" {\\n    margin: auto;\\n    width: 90vw;\\n  }\\n\"]);\n\n  _templateObject9 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject8() {\n  const data = _taggedTemplateLiteral([\"\\n  width: 2vw;\\n  height: 2vw;\\n  cursor: pointer;\\n  transition: transform 0.3s;\\n  outline: none;\\n  margin: auto 0.2vw;\\n  &:hover {\\n    transform: scale(1.1);\\n  }\\n\\n  @media \", \" {\\n    width: 8vw;\\n    height: 8vw;\\n    max-height: 8vw;\\n    font-size: 5vw;\\n  }\\n\"]);\n\n  _templateObject8 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7() {\n  const data = _taggedTemplateLiteral([\"\\n  font-size: 1.2vw;\\n  font-family: \\\"Roboto\\\";\\n  font-weight: 700;\\n  text-transform: uppercase;\\n  color: \", \";\\n  text-align: left;\\n\\n  @media \", \" {\\n    padding-top: 4vw;\\n    font-size: 5vw;\\n  }\\n\"]);\n\n  _templateObject7 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  const data = _taggedTemplateLiteral([\"\\n  width: 70vw;\\n  /* background-color:\", \"; */\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  justify-content: flex-start;\\n\"]);\n\n  _templateObject6 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  const data = _taggedTemplateLiteral([\"\\n  width: 30vw;\\n  /* background-color:\", \" */\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  justify-content: flex-start;\\n\"]);\n\n  _templateObject5 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  const data = _taggedTemplateLiteral([\"\\n  height: 38vh;\\n  display: flex;\\n\"]);\n\n  _templateObject4 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  const data = _taggedTemplateLiteral([\"\\n  position: relative;\\n  margin: auto;\\n  height: 60vh;\\n  overflow: visible;\\n\"]);\n\n  _templateObject3 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  const data = _taggedTemplateLiteral([\"\\n  margin: auto;\\n  position: relative;\\n  width: 90vw;\\n  padding-bottom: 5vw;\\n\"]);\n\n  _templateObject2 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  position: relative;\\n  padding-bottom: 10vw;\\n\"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component } from \"react\";\nimport styled from \"styled-components\";\nimport Feature, { FeatureType as FeatureTypes } from \"../../feature/Feature\";\nimport NewFeature from \"../../feature/NewFeature\";\nimport DreamItem from \"../../dreamItem/DreamItem\";\nimport LoadingWidget from \"../../LoadingWidget\";\nimport { isGibberish } from \"../../../utils/GibberishFilter\";\nimport { devices } from \"../../../config/devices.js\";\nimport Header from \"../../commons/header/Header\";\nimport Button from \"../../commons/Button\";\nimport { confirmAlert } from \"react-confirm-alert\"; // Import\n\nimport \"react-confirm-alert/src/react-confirm-alert.css\"; // Import css\n\nimport { theme } from \"../../../config/colorTheme\";\nimport Prompt from \"../../commons/Prompt\";\nimport TextArea from \"../../commons/TextArea\";\nimport MainHeader from \"../../commons/mainheader/MainHeader\";\nimport UserInfoForm from \"../../userinfo/UserInfoForm\";\nimport Amplify from \"aws-amplify\";\nimport { AmplifyAuthenticator, AmplifySignUp, AmplifySignIn, AmplifySignOut } from \"@aws-amplify/ui-react\";\nconst Wrapper = styled.div(_templateObject());\nconst ContentWrapper = styled.div(_templateObject2());\nconst DroneContainer = styled.div(_templateObject3());\nconst FeatureContainer = styled.div(_templateObject4());\nconst CreateFeatureContainer = styled.div(_templateObject5(), theme.secondaryColor20);\nconst FeatureSetContainer = styled.div(_templateObject6(), theme.primaryColor20);\nconst RowHeader = styled.h3(_templateObject7(), theme.black, devices.mobile);\nconst PaginationButton = styled.img(_templateObject8(), devices.mobile);\nconst FeatureSet = styled.div(_templateObject9(), devices.mobile);\nconst DotWrapper = styled.div(_templateObject10(), devices.mobile);\nconst Dot = styled.div(_templateObject11(), props => props.selected ? theme.secondaryColor : theme.lightGray, devices.mobile);\nconst ButtonWrapper = styled.div(_templateObject12());\n\nvar APICalls = require(\"../../../utils/APICalls\");\n\nconst VISIBLE_FEATURES_COUNT = 3;\nconst FEATURE_SET_SIZE = 12;\n\nclass AddResponsesView extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleAddNewFeatureClick = feature => {\n      let drone = this.state.response;\n\n      if (drone.features.length >= 4) {\n        this.displayMaxFeaturesAlert();\n        return;\n      }\n\n      drone.features.push(feature);\n      this.setState({\n        response: drone\n      });\n      this.updateDrone();\n    };\n\n    this.state = {\n      prompts: [],\n      inputs: [],\n      response: null,\n      showDialog: true\n    };\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0); //fetch the response data using id\n\n    APICalls.readResponse(this.props.match.params.id, data => {\n      APICalls.readPromptsOfTopic(data.topic._id, data => {\n        var inputs = [];\n        data.map((value, index) => {\n          inputs.push({\n            prompt: value._id,\n            text: value.startingLine + \"...\"\n          });\n        });\n        this.setState({\n          inputs: inputs,\n          prompts: data\n        });\n      });\n      this.setState({\n        response: data\n      });\n    });\n  }\n\n  updateResponse() {\n    var body = this.state.response;\n    body.inputs = this.state.inputs;\n    body.isPublished = true;\n    fetch(\"/responses/\" + this.state.response._id, {\n      method: \"PUT\",\n      body: JSON.stringify(body),\n      headers: {\n        Accept: \"application/json, text/plain, */*\",\n        \"Content-Type\": \"application/json\",\n        Mode: \"CORS\"\n      }\n    }).then(data => {\n      console.log(data);\n      alert(\"Response Submitted. Thanks for your creativity!\");\n      this.setState({\n        showDialog: true\n      });\n      window.scrollTo(0, 0); // this.props.history.push(\"../../topic/\" + this.state.response.topic._id);\n    });\n  }\n\n  render() {\n    if (this.state.response == null) return React.createElement(LoadingWidget, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    });\n    return React.createElement(Wrapper, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, this.state.showDialog && React.createElement(UserInfoForm, {\n      onClose: () => {\n        this.setState({\n          showDialog: false\n        });\n        this.props.history.push(\"../../topic/\" + this.state.response.topic._id);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }), React.createElement(MainHeader, {\n      isSmall: true,\n      onClick: () => this.props.history.push(\"../../\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }), React.createElement(Header, {\n      text: \"Tell us more about your dream \" + this.state.response.topic.name.toLowerCase(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }), React.createElement(ContentWrapper, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, React.createElement(DroneContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, React.createElement(DreamItem, {\n      editable: false,\n      drone: this.state.response,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    })), this.state.prompts.map((value, index) => React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, React.createElement(Prompt, {\n      text: value.text,\n      marginTop: \"3vw\",\n      marginBottom: \"1vw\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }), React.createElement(TextArea, {\n      value: this.state.inputs[index].text,\n      rows: 8,\n      placeholder: value.startingLine,\n      onChangeCallback: ev => {\n        var inputs = this.state.inputs;\n        inputs[index].text = ev.target.value;\n        this.setState({\n          inputs: inputs\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    }))), React.createElement(ButtonWrapper, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248\n      },\n      __self: this\n    }, React.createElement(Button, {\n      isDisabled: !this.isCompleted(),\n      onClick: () => this.handleSubmitClick(),\n      text: \"Submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249\n      },\n      __self: this\n    }))));\n  }\n\n  isCompleted() {\n    let input;\n\n    for (let i = 0; i < this.state.inputs.length; i++) {\n      input = this.state.inputs[i].text;\n\n      if (this.state.prompts[i].startingLine.length + 5 < input.length) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  handleSubmitClick() {\n    const message = \"It looks like your submission includes some gibberish. Please make sure your answers are readable. If you believe this is a mistake on our part click skip without making any changes.\";\n    let containsGib = false;\n    let input;\n\n    for (let i = 0; i < this.state.inputs.length; i++) {\n      input = this.state.inputs[i].text;\n\n      if (this.state.prompts[i].startingLine) {\n        input = input.substring(this.state.prompts[i].startingLine.length);\n      }\n\n      if (input.length > 4 && isGibberish(input, 5)) {\n        containsGib = true;\n        break;\n      }\n    }\n\n    if (containsGib) {\n      confirmAlert({\n        title: \"We detected some gibberish!\",\n        message: message,\n        buttons: [{\n          label: \"Skip\",\n          onClick: () => this.updateResponse()\n        }, {\n          label: \"Continue\",\n          onClick: () => {}\n        }]\n      });\n    } else {\n      this.updateResponse();\n    }\n  }\n\n  renderButton() {\n    if (this.state.drone.features.length > 0) {\n      return React.createElement(Button, {\n        onClick: () => {\n          this.props.history.push(\"../story/\" + this.state.drone._id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310\n        },\n        __self: this\n      }, \"Next\");\n    }\n\n    return null;\n  }\n\n  renderScrollDots() {\n    let dots = [];\n    let selected = false;\n    let index = this.state.visiblefeatureIndex;\n    const size = Math.min(this.state.featureSet.length, FEATURE_SET_SIZE);\n\n    for (let i = 0; i < size / VISIBLE_FEATURES_COUNT; i++) {\n      selected = i == index / VISIBLE_FEATURES_COUNT;\n      dots.push(React.createElement(Dot, {\n        selected: selected,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331\n        },\n        __self: this\n      }));\n    }\n\n    return dots;\n  }\n\n  displayMaxFeaturesAlert() {\n    alert(\"Your dream \" + this.state.response.topic.name + \" can have a maximum of 4 superpowers.\");\n  }\n\n  handleNextClick() {\n    let index = this.state.visiblefeatureIndex;\n\n    if (index != null && index + VISIBLE_FEATURES_COUNT < this.state.featureSet.length) {\n      this.setState({\n        visiblefeatureIndex: index + VISIBLE_FEATURES_COUNT\n      });\n    }\n  }\n\n  handlePreviousClick() {\n    let index = this.state.visiblefeatureIndex;\n\n    if (index != null && index - VISIBLE_FEATURES_COUNT >= 0) {\n      this.setState({\n        visiblefeatureIndex: index - VISIBLE_FEATURES_COUNT\n      });\n    }\n  }\n\n}\n\nexport default AddResponsesView;","map":{"version":3,"sources":["/Users/piyum/Desktop/tempfolder/frontend_dreamcollective/src/components/views/activity/AddResponsesView.js"],"names":["React","Component","styled","Feature","FeatureType","FeatureTypes","NewFeature","DreamItem","LoadingWidget","isGibberish","devices","Header","Button","confirmAlert","theme","Prompt","TextArea","MainHeader","UserInfoForm","Amplify","AmplifyAuthenticator","AmplifySignUp","AmplifySignIn","AmplifySignOut","Wrapper","div","ContentWrapper","DroneContainer","FeatureContainer","CreateFeatureContainer","secondaryColor20","FeatureSetContainer","primaryColor20","RowHeader","h3","black","mobile","PaginationButton","img","FeatureSet","DotWrapper","Dot","props","selected","secondaryColor","lightGray","ButtonWrapper","APICalls","require","VISIBLE_FEATURES_COUNT","FEATURE_SET_SIZE","AddResponsesView","constructor","handleAddNewFeatureClick","feature","drone","state","response","features","length","displayMaxFeaturesAlert","push","setState","updateDrone","prompts","inputs","showDialog","componentDidMount","window","scrollTo","readResponse","match","params","id","data","readPromptsOfTopic","topic","_id","map","value","index","prompt","text","startingLine","updateResponse","body","isPublished","fetch","method","JSON","stringify","headers","Accept","Mode","then","console","log","alert","render","history","name","toLowerCase","ev","target","isCompleted","handleSubmitClick","input","i","message","containsGib","substring","title","buttons","label","onClick","renderButton","renderScrollDots","dots","visiblefeatureIndex","size","Math","min","featureSet","handleNextClick","handlePreviousClick"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport styled from \"styled-components\";\nimport Feature, { FeatureType as FeatureTypes } from \"../../feature/Feature\";\nimport NewFeature from \"../../feature/NewFeature\";\nimport DreamItem from \"../../dreamItem/DreamItem\";\nimport LoadingWidget from \"../../LoadingWidget\";\nimport { isGibberish } from \"../../../utils/GibberishFilter\";\nimport { devices } from \"../../../config/devices.js\";\nimport Header from \"../../commons/header/Header\";\nimport Button from \"../../commons/Button\";\nimport { confirmAlert } from \"react-confirm-alert\"; // Import\nimport \"react-confirm-alert/src/react-confirm-alert.css\"; // Import css\n\nimport { theme } from \"../../../config/colorTheme\";\nimport Prompt from \"../../commons/Prompt\";\nimport TextArea from \"../../commons/TextArea\";\nimport MainHeader from \"../../commons/mainheader/MainHeader\";\nimport UserInfoForm from \"../../userinfo/UserInfoForm\";\n\nimport Amplify from \"aws-amplify\";\nimport {\n  AmplifyAuthenticator,\n  AmplifySignUp,\n  AmplifySignIn,\n  AmplifySignOut,\n} from \"@aws-amplify/ui-react\";\n\nconst Wrapper = styled.div`\n  width: 100%;\n  position: relative;\n  padding-bottom: 10vw;\n`;\n\nconst ContentWrapper = styled.div`\n  margin: auto;\n  position: relative;\n  width: 90vw;\n  padding-bottom: 5vw;\n`;\n\nconst DroneContainer = styled.div`\n  position: relative;\n  margin: auto;\n  height: 60vh;\n  overflow: visible;\n`;\n\nconst FeatureContainer = styled.div`\n  height: 38vh;\n  display: flex;\n`;\n\nconst CreateFeatureContainer = styled.div`\n  width: 30vw;\n  /* background-color:${theme.secondaryColor20} */\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: flex-start;\n`;\n\nconst FeatureSetContainer = styled.div`\n  width: 70vw;\n  /* background-color:${theme.primaryColor20}; */\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: flex-start;\n`;\n\nconst RowHeader = styled.h3`\n  font-size: 1.2vw;\n  font-family: \"Roboto\";\n  font-weight: 700;\n  text-transform: uppercase;\n  color: ${theme.black};\n  text-align: left;\n\n  @media ${devices.mobile} {\n    padding-top: 4vw;\n    font-size: 5vw;\n  }\n`;\n\nconst PaginationButton = styled.img`\n  width: 2vw;\n  height: 2vw;\n  cursor: pointer;\n  transition: transform 0.3s;\n  outline: none;\n  margin: auto 0.2vw;\n  &:hover {\n    transform: scale(1.1);\n  }\n\n  @media ${devices.mobile} {\n    width: 8vw;\n    height: 8vw;\n    max-height: 8vw;\n    font-size: 5vw;\n  }\n`;\n\nconst FeatureSet = styled.div`\n  display: flex;\n  justify-content: space-around;\n  @media ${devices.mobile} {\n    margin: auto;\n    width: 90vw;\n  }\n`;\n\nconst DotWrapper = styled.div`\n  width: 10vw;\n  height: 1.8vh;\n  margin: auto;\n  display: flex;\n  justify-content: space-around;\n\n  @media ${devices.mobile} {\n    width: 20vw;\n    height: 3vw;\n  }\n`;\n\nconst Dot = styled.div`\n  width: 1.5vh;\n  height: 1.5vh;\n  background-color: ${(props) =>\n    props.selected ? theme.secondaryColor : theme.lightGray};\n  border-radius: 5vw;\n\n  @media ${devices.mobile} {\n    width: 2vw;\n    height: 2vw;\n    margin: 4vw auto;\n  }\n`;\n\nconst ButtonWrapper = styled.div`\n  width: 20vw;\n  margin-top: 4vw;\n\n  float: right;\n`;\n\nvar APICalls = require(\"../../../utils/APICalls\");\n\nconst VISIBLE_FEATURES_COUNT = 3;\nconst FEATURE_SET_SIZE = 12;\n\nclass AddResponsesView extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      prompts: [],\n      inputs: [],\n      response: null,\n      showDialog: true,\n    };\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    //fetch the response data using id\n    APICalls.readResponse(this.props.match.params.id, (data) => {\n      APICalls.readPromptsOfTopic(data.topic._id, (data) => {\n        var inputs = [];\n        data.map((value, index) => {\n          inputs.push({ prompt: value._id, text: value.startingLine + \"...\" });\n        });\n        this.setState({ inputs: inputs, prompts: data });\n      });\n      this.setState({ response: data });\n    });\n  }\n\n  updateResponse() {\n    var body = this.state.response;\n    body.inputs = this.state.inputs;\n    body.isPublished = true;\n    fetch(\"/responses/\" + this.state.response._id, {\n      method: \"PUT\",\n      body: JSON.stringify(body),\n      headers: {\n        Accept: \"application/json, text/plain, */*\",\n        \"Content-Type\": \"application/json\",\n        Mode: \"CORS\",\n      },\n    }).then((data) => {\n      console.log(data);\n      alert(\"Response Submitted. Thanks for your creativity!\");\n      this.setState({ showDialog: true });\n      window.scrollTo(0, 0);\n      // this.props.history.push(\"../../topic/\" + this.state.response.topic._id);\n    });\n  }\n\n  render() {\n    if (this.state.response == null) return <LoadingWidget></LoadingWidget>;\n    return (\n      <Wrapper>\n        {this.state.showDialog && (\n          <UserInfoForm\n            onClose={() => {\n              this.setState({ showDialog: false });\n              this.props.history.push(\n                \"../../topic/\" + this.state.response.topic._id\n              );\n            }}\n          ></UserInfoForm>\n        )}\n        <MainHeader\n          isSmall={true}\n          onClick={() => this.props.history.push(\"../../\")}\n        ></MainHeader>\n\n        <Header\n          text={\n            \"Tell us more about your dream \" +\n            this.state.response.topic.name.toLowerCase()\n          }\n        ></Header>\n        <ContentWrapper>\n          <DroneContainer>\n            <DreamItem editable={false} drone={this.state.response}></DreamItem>\n          </DroneContainer>\n          {this.state.prompts.map((value, index) => (\n            <div>\n              <Prompt\n                text={value.text}\n                marginTop={\"3vw\"}\n                marginBottom={\"1vw\"}\n              ></Prompt>\n              <TextArea\n                value={this.state.inputs[index].text}\n                rows={8}\n                placeholder={value.startingLine}\n                onChangeCallback={(ev) => {\n                  var inputs = this.state.inputs;\n                  inputs[index].text = ev.target.value;\n                  this.setState({ inputs: inputs });\n                }}\n              ></TextArea>\n            </div>\n          ))}\n\n          <ButtonWrapper>\n            <Button\n              isDisabled={!this.isCompleted()}\n              onClick={() => this.handleSubmitClick()}\n              text={\"Submit\"}\n            ></Button>\n          </ButtonWrapper>\n        </ContentWrapper>\n      </Wrapper>\n    );\n  }\n\n  isCompleted() {\n    let input;\n    for (let i = 0; i < this.state.inputs.length; i++) {\n      input = this.state.inputs[i].text;\n      if (this.state.prompts[i].startingLine.length + 5 < input.length) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  handleSubmitClick() {\n    const message =\n      \"It looks like your submission includes some gibberish. Please make sure your answers are readable. If you believe this is a mistake on our part click skip without making any changes.\";\n\n    let containsGib = false;\n    let input;\n    for (let i = 0; i < this.state.inputs.length; i++) {\n      input = this.state.inputs[i].text;\n      if (this.state.prompts[i].startingLine) {\n        input = input.substring(this.state.prompts[i].startingLine.length);\n      }\n      if (input.length > 4 && isGibberish(input, 5)) {\n        containsGib = true;\n        break;\n      }\n    }\n    if (containsGib) {\n      confirmAlert({\n        title: \"We detected some gibberish!\",\n        message: message,\n        buttons: [\n          {\n            label: \"Skip\",\n            onClick: () => this.updateResponse(),\n          },\n          {\n            label: \"Continue\",\n            onClick: () => {},\n          },\n        ],\n      });\n    } else {\n      this.updateResponse();\n    }\n  }\n\n  renderButton() {\n    if (this.state.drone.features.length > 0) {\n      return (\n        <Button\n          onClick={() => {\n            this.props.history.push(\"../story/\" + this.state.drone._id);\n          }}\n        >\n          Next\n        </Button>\n      );\n    }\n    return null;\n  }\n\n  renderScrollDots() {\n    let dots = [];\n    let selected = false;\n    let index = this.state.visiblefeatureIndex;\n\n    const size = Math.min(this.state.featureSet.length, FEATURE_SET_SIZE);\n\n    for (let i = 0; i < size / VISIBLE_FEATURES_COUNT; i++) {\n      selected = i == index / VISIBLE_FEATURES_COUNT;\n      dots.push(<Dot selected={selected}></Dot>);\n    }\n    return dots;\n  }\n\n  handleAddNewFeatureClick = (feature) => {\n    let drone = this.state.response;\n    if (drone.features.length >= 4) {\n      this.displayMaxFeaturesAlert();\n      return;\n    }\n    drone.features.push(feature);\n    this.setState({ response: drone });\n    this.updateDrone();\n  };\n\n  displayMaxFeaturesAlert() {\n    alert(\n      \"Your dream \" +\n        this.state.response.topic.name +\n        \" can have a maximum of 4 superpowers.\"\n    );\n  }\n\n  handleNextClick() {\n    let index = this.state.visiblefeatureIndex;\n    if (\n      index != null &&\n      index + VISIBLE_FEATURES_COUNT < this.state.featureSet.length\n    ) {\n      this.setState({ visiblefeatureIndex: index + VISIBLE_FEATURES_COUNT });\n    }\n  }\n\n  handlePreviousClick() {\n    let index = this.state.visiblefeatureIndex;\n    if (index != null && index - VISIBLE_FEATURES_COUNT >= 0) {\n      this.setState({ visiblefeatureIndex: index - VISIBLE_FEATURES_COUNT });\n    }\n  }\n}\n\nexport default AddResponsesView;\n"]},"metadata":{},"sourceType":"module"}